{"id":"quTw","dependencies":[{"name":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\package.json","includedInParent":true,"mtime":1737120279329}],"generated":{"js":"function e(t){return(e=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e})(t)}function t(e){return i(e)||r(e)||o(e)||n()}function n(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function o(e,t){if(e){if(\"string\"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return\"Object\"===n&&e.constructor&&(n=e.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(e):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function r(e){if(\"undefined\"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e[\"@@iterator\"])return Array.from(e)}function i(e){if(Array.isArray(e))return a(e)}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){s(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function s(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(t){var n=u(t,\"string\");return\"symbol\"==e(n)?n:n+\"\"}function u(t,n){if(\"object\"!=e(t)||!t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,n||\"default\");if(\"object\"!=e(r))return r;throw new TypeError(\"@@toPrimitive must return a primitive value.\")}return(\"string\"===n?String:Number)(t)}document.addEventListener(\"DOMContentLoaded\",function(){console.time(\"Total Initialization\"),console.log(\"Initialization started\");var e=document.getElementById(\"infoCardOverlay\");sessionStorage.getItem(\"hasVisitedBefore\")||setTimeout(function(){e.classList.add(\"show\")},100),document.getElementById(\"closeInfoCard\").addEventListener(\"click\",function(){e.classList.remove(\"show\"),sessionStorage.setItem(\"hasVisitedBefore\",\"true\")}),console.time(\"Map Initialization\");var n=L.map(\"map\").setView([0,0],2),o=L.divIcon({className:\"custom-div-icon\",html:'<i style=\"color: #e5007d;\" class=\"fa fa-map-marker fa-3x\"></i>',iconSize:[30,42],iconAnchor:[15,42]}),r=L.divIcon({className:\"custom-div-icon\",html:'<i style=\"color: #3694d1;\" class=\"fa fa-map-marker fa-3x\"></i>',iconSize:[30,42],iconAnchor:[15,42]}),i=L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",{attribution:'&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',maxZoom:10}),a=L.tileLayer(\"https://stamen-tiles-{s}.a.ssl.fastly.net/terrain/{z}/{x}/{y}{r}.png\",{attribution:'Map tiles by <a href=\"http://stamen.com\">Stamen Design</a>, <a href=\"http://creativecommons.org/licenses/by/3.0\">CC BY 3.0</a> &mdash; Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',subdomains:\"abcd\",minZoom:0,maxZoom:10}),c=document.querySelectorAll(\".switch-button\"),s=document.getElementById(\"map-overview-btn\"),d=(document.getElementById(\"list-btn\"),document.getElementById(\"map\")),u=document.getElementById(\"mask\");function f(){s.classList.contains(\"active\")?(d.style.display=\"block\",u.style.display=\"none\"):(d.style.display=\"none\",u.style.display=\"block\")}c.forEach(function(e){e.addEventListener(\"click\",function(){c.forEach(function(e){return e.classList.remove(\"active\")}),e.classList.add(\"active\"),f()})}),f();var p=i.addTo(n);var h=0;p.on(\"tileerror\",function(e){console.log(\"Tile loading error:\",e),++h>=5&&(console.log(\"\".concat(5,\" consecutive errors. Switching tile layer.\")),n.removeLayer(p),p===i?(p=a.addTo(n),console.log(\"Switched to Stamen Terrain tiles\")):(p=i.addTo(n),console.log(\"Switched to OpenStreetMap tiles\")),h=0)}),p.on(\"tileload\",function(){h=0});var m=L.markerClusterGroup({chunkedLoading:!0,chunkInterval:200,chunkDelay:50});n.addLayer(m);var g=L.control({position:\"bottomright\"});g.onAdd=function(e){var t=L.DomUtil.create(\"div\",\"info legend\");return t.innerHTML='\\n        <div class=\"legend-content\">\\n            <h4>Location Precision</h4>\\n            <i style=\"color: #3694d1;\" class=\"fa fa-map-marker\"></i> Specific Location in Country (e.g., city, facility)<br>\\n            <i style=\"color: #e5007d;\" class=\"fa fa-map-marker\"></i> Country Only (no specific location)\\n        </div>\\n    ',t};var v=!1;console.timeEnd(\"Map Initialization\"),console.time(\"DataTable Initialization\");var y=$(\"#dc-data-table\").DataTable({searching:!1,lengthChange:!1,columns:[{data:\"Title\",width:\"50%\",defaultContent:\"N/A\",render:function(e,t,n){return e?'\"'.concat(e,'\"'):\"N/A\"}},{data:\"country\"},{data:\"url\",render:function(e,t,n){return e?'<a href=\"'.concat(e,'\" target=\"_blank\">Link</a>'):\"\"}},{data:\"Date\"},{data:\"Corruption Categories\",render:function(e,t,n){return e?String(e).replace(/,(?=[^\\s])/g,\", \"):\"\"}}],columnDefs:[{type:\"date-eu\",targets:3}],order:[[3,\"desc\"]]});console.timeEnd(\"DataTable Initialization\"),jQuery.extend(jQuery.fn.dataTableExt.oSort,{\"date-eu-pre\":function(e){return e.indexOf(\"Cancelled\")>-1&&(e=e.split(\" \")[0]),B(e)},\"date-eu-asc\":function(e,t){return e<t?-1:e>t?1:0},\"date-eu-desc\":function(e,t){return e<t?1:e>t?-1:0}});var b=new Intl.NumberFormat(void 0,{maximumFractionDigits:0});function w(e){return b.format(e)}var k,C,D=[],S=[],E=new Map;function I(e,t){var n;return function(){for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];clearTimeout(n),n=setTimeout(function(){clearTimeout(n),e.apply(void 0,r)},t)}}console.time(\"Data Fetching\"),fetch(\"./data/loc3.json\").then(function(e){return e.json()}).then(function(e){console.timeEnd(\"Data Fetching\"),function(e){console.time(\"Data Processing\");var n=d3.timeParse(\"%d/%m/%y\");D=e.map(function(e){return l(l({},e),{},{parsedDate:n(e.Date)})}),$(\".total-count\").text(w(D.length));var o=t(new Set(D.map(function(e){return e.country}))).sort(function(e,t){return e.localeCompare(t)}),r=t(new Set(D.flatMap(function(e){return e[\"Corruption Categories\"]}))).sort(function(e,t){return e.localeCompare(t)}),i=t(new Set(D.flatMap(function(e){return e[\"Sector Categories\"]}))).sort(function(e,t){return e.localeCompare(t)});j(\"#countryFilter\",o,\"Select multiple\"),j(\"#corruptionCategoriesFilter\",r,\"Select multiple\"),j(\"#healthCategoriesFilter\",i,\"Select multiple\"),k=d3.min(D,function(e){return e.parsedDate}),C=d3.max(D,function(e){return e.parsedDate}),$(\"#startDate, #endDate\").datepicker({format:\"dd/mm/yy\",autoclose:!0}).on(\"changeDate\",function(){z(),M()}),$(\"#startDate\").datepicker(\"setDate\",k),$(\"#endDate\").datepicker(\"setDate\",C),$(\"#resetFilters\").on(\"click\",function(){F()&&($(\"#countryFilter, #corruptionCategoriesFilter, #healthCategoriesFilter\").val(null).trigger(\"change\"),$(\"#startDate\").datepicker(\"setDate\",k),$(\"#endDate\").datepicker(\"setDate\",C),$(\"#search-input\").val(\"\"),x.checked=!1,T.checked=!0,A.checked=!0,O.checked=!0,z(),M(),v&&(g.remove(),v=!1))}),$(\"#search-input\").on(\"input\",I(function(){z(),M()},500)),console.timeEnd(\"Data Processing\"),z(),M()}(e)}).catch(function(e){return console.error(\"Error loading data:\",e)});var x=document.getElementById(\"archivedFilter\"),T=document.getElementById(\"caseFilter\"),A=document.getElementById(\"unreliableFilter\"),O=document.getElementById(\"countryLevelFilter\");function j(e,t,n){$(e).select2({data:t.map(function(e){return{id:e,text:e}}),placeholder:n}).on(\"change\",function(){z(),M()})}function F(){var e=$(\"#countryFilter\").val()||[],t=$(\"#corruptionCategoriesFilter\").val()||[],n=$(\"#healthCategoriesFilter\").val()||[],o=$(\"#startDate\").datepicker(\"getDate\"),r=$(\"#endDate\").datepicker(\"getDate\"),i=$(\"#search-input\").val().trim(),a=x.checked,c=!A.checked,l=!T.checked,s=!O.checked,d=o&&k&&o.getTime()!==k.getTime()||r&&C&&r.getTime()!==C.getTime();return e.length>0||t.length>0||n.length>0||d||\"\"!==i||a||c||l||s}function M(){F()?$(\"#resetFilters\").show():$(\"#resetFilters\").hide()}var B=d3.timeParse(\"%d/%m/%y\");function z(){console.time(\"Filtering Data\");var e=new Set($(\"#countryFilter\").val()||[]),t=new Set($(\"#corruptionCategoriesFilter\").val()||[]),i=new Set($(\"#healthCategoriesFilter\").val()||[]),a=$(\"#startDate\").datepicker(\"getDate\"),c=$(\"#endDate\").datepicker(\"getDate\"),l=$(\"#search-input\").val().toLowerCase().trim(),s=x.checked,d=T.checked,u=A.checked,f=O.checked;S=D.filter(function(n){var o=0===e.size||e.has(n.country),r=0===t.size||n[\"Corruption Categories\"].some(function(e){return t.has(e)}),p=0===i.size||n[\"Sector Categories\"].some(function(e){return i.has(e)}),h=!0;a&&c&&n.parsedDate&&(h=n.parsedDate>=a&&n.parsedDate<=c);var m=!0;if(l){var g=n.Title.toLowerCase();m=l.startsWith('\"')&&l.endsWith('\"')?g.includes(l.slice(1,-1)):l.split(\" \").every(function(e){return g.includes(e)})}var v=!s||!n.Archived,y=!d||n.c_n,b=!u||!n.f_n,w=!f||!n.country_level;return o&&r&&p&&h&&m&&v&&b&&y&&w}),console.timeEnd(\"Filtering Data\"),function(){if(console.time(\"Updating Map and Table\"),m.clearLayers(),E.clear(),S.length>0){var e=1e3,t=0;!function i(){var a=Math.min(t+e,S.length);var c=[];for(var l=t;l<a;l++){var s=S[l],d=\"\".concat(s.lat,\"-\").concat(s.long,\"-\").concat(s.Title);if(!E.has(d)){var u=s.country_level?o:r,f=L.marker([s.lat,s.long],{icon:u}).bindPopup('\\n                                <div class=\"popup-content\">\\n                                    <h3 class=\"popup-title\">\"'.concat(s.Title,'\"</h3>\\n                                    <div class=\"popup-details\">\\n                                        <p><strong>Country:</strong> ').concat(s.country,'</p>\\n                                        <p><strong>URL:</strong> <a href=\"').concat(s.url,'\" target=\"_blank\">Link</a></p>\\n                                        <p><strong>Date:</strong> ').concat(s.Date,\"</p>\\n                                        <p><strong>Integrity Area:</strong> \").concat(String(s[\"Corruption Categories\"]||\"\").replace(/,(?=[^\\s])/g,\", \"),\"</p>\\n                                        <p><strong>Sector Area:</strong> \").concat(String(s[\"Sector Categories\"]||\"\").replace(/,(?=[^\\s])/g,\", \"),\"</p>\\n                                    </div>\\n                                </div>\\n                            \"));c.push(f),E.set(d,f)}}m.addLayers(c);t=a;t<S.length?setTimeout(i,0):(n.fitBounds(m.getBounds()),P())}()}else P();console.timeEnd(\"Updating Map and Table\")}()}document.querySelector(\"#clicker\").addEventListener(\"click\",function(){var e=document.querySelector(\".filter-content\"),t=document.querySelector(\".expand-icon\");e.classList.toggle(\"expanded\"),t.classList.toggle(\"expanded\")});var P=I(function(){if(console.time(\"Updating Visible Data\"),!n.isMoving()){var e=n.getBounds(),t=S.filter(function(t){return e.contains(L.latLng(t.lat,t.long))});y.clear().rows.add(t).draw(),$(\".filter-count\").text(w(t.length)),console.timeEnd(\"Updating Visible Data\")}},1e3);n.on(\"movestart\",function(){n.isMoving=function(){return!0}}),n.on(\"moveend\",function(){n.isMoving=function(){return!1},P()});var U={country:\"Country mentioned in the article. This is usually, but not always, where the story occured.\",corruption:\"We used AI to identify when a story is related to a particular theme related to integrity. See our 'About' page for qualifications and limitations.\",health:\"We used AI to identify when a story is related to a particular area of health. See our 'About' page for qualifications and limitations.\",date:\"Set a date range to view which events have happened within a specific time period. Our archived data uses publication date.\",archived:\"When checked, this includes articles collected using our earlier data gathering methods. We've since improved our collection process. Unchecked shows only articles collected with our current methods.\",cased:\"When checked, this filters out general discussions and commentaries to focus on stories about specific corruption cases. Check it to include all articles.\",unreliable:\"We use AI to identify potentially unreliable news stories based on their writing style and content. While keeping this checked can help reduce exposure to low-quality news, please note: The filter works automatically with no human oversight. It may incorrectly flag legitimate stories as unreliable. It may miss unreliable stories. It can reflect biases present in AI training data. Think of it as a helpful but unverified first pass rather than a definitive assessment of reliability.\",countryLevel:\"When checked, this shows only articles where a specific location within the country could be determined. Check it to include articles where only the country-level location was identified.\"},W=null;function _(e){console.log(\"Info icon clicked:\",this.id),e.preventDefault(),e.stopPropagation();var t=this.getAttribute(\"data-filter\");!function(e,t){console.log(\"Creating info box for:\",e),W&&W.remove();var n=document.createElement(\"div\");n.className=\"info-box\",n.textContent=e,document.body.appendChild(n);var o=t.getBoundingClientRect();n.style.top=\"\".concat(o.bottom+window.scrollY+5,\"px\"),n.style.left=\"\".concat(o.left+window.scrollX-150,\"px\"),n.style.display=\"block\",W=n,console.log(\"Info box created and displayed\")}(U[t],this)}x.addEventListener(\"change\",function(){z(),M()}),A.addEventListener(\"change\",function(){z(),M()}),T.addEventListener(\"change\",function(){z(),M()}),O.addEventListener(\"change\",function(){this.checked||v?this.checked&&v&&(g.remove(),v=!1):(g.addTo(n),v=!0),z(),M()});[\"main-info\",\"country-info\",\"corruption-info\",\"health-info\",\"date-info\",\"archived-info\",\"case-info\",\"unreliable-info\",\"country-level-info\"].forEach(function(e){var t=document.getElementById(e);t?(console.log(\"Attaching click event to:\",e),t.addEventListener(\"click\",_),t.addEventListener(\"mousedown\",function(e){return e.preventDefault()})):console.warn(\"Info icon not found:\",e)}),document.addEventListener(\"click\",function(e){W&&!e.target.classList.contains(\"info-icon\")&&(console.log(\"Closing info box\"),W.remove(),W=null)}),$(\".filter-group select\").off(\"select2:open\");$(\"<button>\").addClass(\"btn btn-sm btn-outline-secondary export-csv-button btn-sharer\").html('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-box-arrow-down\" viewBox=\"0 0 16 16\"><path fill-rule=\"evenodd\" d=\"M3.5 10a.5.5 0 0 1-.5-.5v-8a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 0 0 1h2A1.5 1.5 0 0 0 14 9.5v-8A1.5 1.5 0 0 0 12.5 0h-9A1.5 1.5 0 0 0 2 1.5v8A1.5 1.5 0 0 0 3.5 11h2a.5.5 0 0 0 0-1z\"/><path fill-rule=\"evenodd\" d=\"M7.646 15.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 14.293V5.5a.5.5 0 0 0-1 0v8.793l-2.146-2.147a.5.5 0 0 0-.708.708z\"/></svg>').attr(\"title\",\"Export filtered data to CSV\").appendTo(\"#export-button-container\").on(\"click\",function(){var e=S,t=[];t.push([\"Title\",\"Country/Region\",\"URL\",\"Date\"].join(\",\")),e.forEach(function(e){var n=['\"'+(e.Title||\"\").replace(/\"/g,'\"\"')+'\"','\"'+(e.country||\"\").replace(/\"/g,'\"\"')+'\"','\"'+(e.url||\"\").replace(/\"/g,'\"\"')+'\"','\"'+(e.Date||\"\").replace(/\"/g,'\"\"')+'\"'];t.push(n.join(\",\"))});var n=t.join(\"\\n\"),o=new Blob([n],{type:\"text/csv;charset=utf-8;\"}),r=document.createElement(\"a\");if(void 0!==r.download){var i=URL.createObjectURL(o);r.setAttribute(\"href\",i),r.setAttribute(\"download\",\"export.csv\"),r.style.visibility=\"hidden\",document.body.appendChild(r),r.click(),document.body.removeChild(r)}}),$(\"<button>\").addClass(\"btn btn-sm btn-outline-secondary export-csv-button btn-sharer\").html('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 512 512\"><path d=\"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3l58.3 0c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24l0-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1l-58.3 0c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z\"/></svg>').attr(\"title\",\"Open the Quick start menu\").appendTo(\"#help-button-container\").css({\"min-height\":\"34px\",display:\"flex\",\"align-items\":\"center\",\"justify-content\":\"center\"}).on(\"click\",function(){$(\"#infoCardOverlay\").addClass(\"show\")});$(\"#closeInfoCard\").on(\"click\",function(){$(\"#infoCardOverlay\").removeClass(\"show\")}),$(\"#infoCardOverlay\").on(\"click\",function(e){e.target===this&&$(this).removeClass(\"show\")});var R=document.getElementById(\"twitter_share\");R&&R.addEventListener(\"click\",function(){var e=window.location.href.split(\"?\")[0],t=\"https://twitter.com/intent/tweet?text=\"+encodeURIComponent(\"Explore global health sector integrity issues and scandals: \"+e);window.open(t,\"_blank\")});var q=document.getElementById(\"lin_share\");q&&q.addEventListener(\"click\",function(){window.location.href.split(\"?\")[0];var e=\"https://www.facebook.com/sharer/sharer.php?u=\"+encodeURIComponent(\"https://ti-health.org/\");window.open(e,\"_blank\",\"toolbar=no,location=0,status=no,menubar=no,scrollbars=yes,resizable=yes,width=600,height=250,top=300,left=300\")}),console.timeEnd(\"Total Initialization\")});"},"sourceMaps":null,"error":null,"hash":"6eadcebb4219d0fd865d0794f3e82700","cacheData":{"env":{}}}