{"id":"KAS3","dependencies":[{"name":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\package.json","includedInParent":true,"mtime":1742042086953},{"name":"d3","loc":{"line":4,"column":20,"index":94},"parent":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\src\\modules\\interconnectionChart.js","resolved":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\node_modules\\d3\\index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0,exports.initializeInterconnectionChart=s,exports.updateInterconnectionChart=u;var t=r(require(\"d3\"));function e(t){if(\"function\"!=typeof WeakMap)return null;var r=new WeakMap,n=new WeakMap;return(e=function(t){return t?n:r})(t)}function r(t,r){if(!r&&t&&t.__esModule)return t;if(null===t||\"object\"!=typeof t&&\"function\"!=typeof t)return{default:t};var n=e(r);if(n&&n.has(t))return n.get(t);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(\"default\"!==i&&{}.hasOwnProperty.call(t,i)){var c=o?Object.getOwnPropertyDescriptor(t,i):null;c&&(c.get||c.set)?Object.defineProperty(a,i,c):a[i]=t[i]}return a.default=t,n&&n.set(t,a),a}function n(t,e){return l(t)||c(t,e)||o(t,e)||a()}function a(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function o(t,e){if(t){if(\"string\"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return\"Object\"===r&&t.constructor&&(r=t.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(t):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){var r=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=r){var n,a,o,i,c=[],l=!0,s=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==e);l=!0);}catch(t){s=!0,a=t}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}function l(t){if(Array.isArray(t))return t}function s(){var e=t.select(\"#interconnection-chart\"),r=40,n=40,a=40,o=40,i=document.getElementById(\"interconnection-chart\").clientWidth||500,c=Math.max(i-o-n,100),l=300-r-a,s=e.append(\"svg\").attr(\"width\",c+o+n).attr(\"height\",l+r+a).append(\"g\").attr(\"transform\",\"translate(\".concat(c/2+o,\",\").concat(l/2+r,\")\"));return s.append(\"text\").attr(\"class\",\"placeholder-text\").attr(\"x\",0).attr(\"y\",0).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"Loading interconnection visualization...\"),s}function u(e,r){if(console.log(\"Updating interconnection chart with \".concat(r.length,\" data points\")),e.selectAll(\"*\").remove(),0!==r.length){var a=new Set,o=new Set;r.forEach(function(t){Array.isArray(t[\"Corruption Categories\"])&&t[\"Corruption Categories\"].forEach(function(t){t&&t.trim()&&a.add(t)}),Array.isArray(t[\"Sector Categories\"])&&t[\"Sector Categories\"].forEach(function(t){t&&t.trim()&&o.add(t)})});var i=function(t,e,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o={};return Array.from(t).forEach(function(t){o[t]=0,e.forEach(function(e){Array.isArray(e[r])&&e[r].includes(t)&&o[t]++})}),Object.entries(o).sort(function(t,e){return e[1]-t[1]}).slice(0,a).map(function(t){var e=n(t,2);return{name:e[0],count:e[1],type:r}})},c=i(a,r,\"Corruption Categories\",5),l=i(o,r,\"Sector Categories\",5),s=[],u=[];if(c.forEach(function(t){l.forEach(function(e){var n=0;r.forEach(function(r){var a=Array.isArray(r[\"Corruption Categories\"])&&r[\"Corruption Categories\"].includes(t.name),o=Array.isArray(r[\"Sector Categories\"])&&r[\"Sector Categories\"].includes(e.name);a&&o&&n++}),n>0&&u.push({source:t.name,target:e.name,value:n})}),s.push({id:t.name,group:\"integrity\",count:t.count})}),l.forEach(function(t){s.push({id:t.name,group:\"health\",count:t.count})}),0!==u.length){var d=document.getElementById(\"interconnection-chart\").clientWidth||600,f=.4*Math.min(d,300),p=t.scaleOrdinal().domain([\"integrity\",\"health\"]).range([\"#3694d1\",\"#e5007d\"]),y=t.scaleLinear().domain([0,t.max(s,function(t){return t.count})]).range([5,15]),h=t.scaleLinear().domain([0,t.max(u,function(t){return t.value})]).range([1,5]),g=t.forceSimulation(s).force(\"link\",t.forceLink(u).id(function(t){return t.id}).distance(.8*f)).force(\"charge\",t.forceManyBody().strength(-100)).force(\"center\",t.forceCenter(0,0)).force(\"collide\",t.forceCollide(function(t){return y(t.count)+25}).strength(1)).alphaDecay(.01).velocityDecay(.6);e.append(\"circle\").attr(\"r\",f).style(\"fill\",\"none\").style(\"stroke\",\"#eee\").style(\"stroke-width\",1).style(\"stroke-dasharray\",\"3,3\");var v=e.append(\"g\").attr(\"class\",\"links\").selectAll(\"path\").data(u).enter().append(\"path\").attr(\"class\",\"link\").style(\"stroke\",function(t){var r=\"link-gradient-\".concat(t.source.id.replace(/\\s+/g,\"-\"),\"-\").concat(t.target.id.replace(/\\s+/g,\"-\")),n=e.append(\"defs\").append(\"linearGradient\").attr(\"id\",r).attr(\"gradientUnits\",\"userSpaceOnUse\");return n.append(\"stop\").attr(\"offset\",\"0%\").attr(\"stop-color\",p(\"integrity\")),n.append(\"stop\").attr(\"offset\",\"100%\").attr(\"stop-color\",p(\"health\")),\"url(#\".concat(r,\")\")}).style(\"stroke-width\",function(t){return h(t.value)}).style(\"stroke-opacity\",.6).style(\"fill\",\"none\"),x=e.append(\"g\").attr(\"class\",\"nodes\").selectAll(\"g\").data(s).enter().append(\"g\").attr(\"class\",\"node\");x.append(\"circle\").attr(\"r\",function(t){return y(t.count)}).attr(\"fill\",function(t){return p(t.group)}).style(\"stroke\",\"#fff\").style(\"stroke-width\",1.5).style(\"cursor\",\"pointer\").on(\"mouseover\",function(e){var r=u.filter(function(t){return t.source.id===e.id||t.target.id===e.id}).map(function(t){return t.source.id===e.id?t.target.id:t.source.id});t.selectAll(\".link\").style(\"stroke-opacity\",function(t){return t.source.id===e.id||t.target.id===e.id?1:.1}),t.selectAll(\".node circle\").style(\"opacity\",function(t){return t.id===e.id||r.includes(t.id)?1:.2}),t.selectAll(\".node text\").style(\"opacity\",function(t){return t.id===e.id||r.includes(t.id)?1:.2});var n=t.select(\"#interconnection-chart\").append(\"div\").attr(\"class\",\"chart-tooltip\").style(\"position\",\"absolute\").style(\"left\",\"\".concat(t.event.pageX-t.select(\"#interconnection-chart\").node().getBoundingClientRect().left,\"px\")).style(\"top\",\"\".concat(t.event.pageY-t.select(\"#interconnection-chart\").node().getBoundingClientRect().top-40,\"px\")),a=u.filter(function(t){return t.source.id===e.id||t.target.id===e.id}).length;n.html('\\n                <div class=\"chart-tooltip-title\">'.concat(e.id,'</div>\\n                <div><span class=\"chart-tooltip-value\">').concat(e.count,\"</span> articles</div>\\n                <div>Connected to \").concat(a,\" \").concat(\"integrity\"===e.group?\"health\":\"integrity\",\" categories</div>\\n            \"))}).on(\"mouseout\",function(){t.selectAll(\".link\").style(\"stroke-opacity\",.6),t.selectAll(\".node circle\").style(\"opacity\",1),t.selectAll(\".node text\").style(\"opacity\",1),t.selectAll(\".chart-tooltip\").remove()}),x.append(\"text\").text(function(t){return t.id.length>15?t.id.substring(0,12)+\"...\":t.id}).attr(\"dy\",function(t){return y(t.count)+12}).style(\"text-anchor\",\"middle\").style(\"font-size\",\"10px\").style(\"fill\",function(e){return t.rgb(p(e.group)).darker()}).style(\"pointer-events\",\"none\").style(\"font-weight\",\"bold\"),e.append(\"text\").attr(\"x\",-f-30).attr(\"y\",15-f).text(\"Integrity Categories\").style(\"font-size\",\"11px\").style(\"fill\",p(\"integrity\")).style(\"font-weight\",\"bold\"),e.append(\"text\").attr(\"x\",f-50).attr(\"y\",15-f).text(\"Health Categories\").style(\"font-size\",\"11px\").style(\"fill\",p(\"health\")).style(\"font-weight\",\"bold\"),v.attr(\"stroke-dasharray\",function(){var t=this.getTotalLength();return\"\".concat(t,\" \").concat(t)}).attr(\"stroke-dashoffset\",function(){return this.getTotalLength()}).transition().duration(1e3).ease(t.easeLinear).attr(\"stroke-dashoffset\",0),x.attr(\"opacity\",0).transition().delay(function(t,e){return 50*e}).duration(500).attr(\"opacity\",1),g.on(\"tick\",function(){var t=s.filter(function(t){return\"integrity\"===t.group}).length,e=s.filter(function(t){return\"health\"===t.group}).length,r=0,n=0;s.forEach(function(a){if(\"integrity\"===a.group){var o=Math.PI/(t+1),i=Math.PI+(r+1)*o-Math.PI/2;a.x=Math.cos(i)*f*.8,a.y=Math.sin(i)*f*.8,r++}else{var c=Math.PI/(e+1),l=(n+1)*c-Math.PI/2;a.x=Math.cos(l)*f*.8,a.y=Math.sin(l)*f*.8,n++}}),v.attr(\"d\",function(t){var e=t.target.x-t.source.x,r=t.target.y-t.source.y,n=1.5*Math.sqrt(e*e+r*r);return\"M\".concat(t.source.x,\",\").concat(t.source.y,\"A\").concat(n,\",\").concat(n,\" 0 0,1 \").concat(t.target.x,\",\").concat(t.target.y)}),x.attr(\"transform\",function(t){return\"translate(\".concat(t.x,\",\").concat(t.y,\")\")})}),g.alpha(1).restart(),g.alphaMin(.001).alphaTarget(0).alphaDecay(.02),setTimeout(function(){g.stop(),function(t,e){for(var r=0;r<30;r++){for(var n=!1,a=0;a<t.length;a++)for(var o=a+1;o<t.length;o++){var i=t[a],c=t[o],l=c.x-i.x,s=c.y-i.y,u=Math.sqrt(l*l+s*s),d=e(i.count)+e(c.count)+10;if(u<d){n=!0;var f=l/u*(d-u)*.5,p=s/u*(d-u)*.5;i.x-=f,i.y-=p,c.x+=f,c.y+=p}}if(!n)break}}(s,y),x.attr(\"transform\",function(t){return\"translate(\".concat(t.x,\",\").concat(t.y,\")\")}),v.attr(\"d\",function(t){var e=t.target.x-t.source.x,r=t.target.y-t.source.y,n=1.5*Math.sqrt(e*e+r*r);return\"M\".concat(t.source.x,\",\").concat(t.source.y,\"A\").concat(n,\",\").concat(n,\" 0 0,1 \").concat(t.target.x,\",\").concat(t.target.y)})},3e3)}else e.append(\"text\").attr(\"class\",\"no-data-message\").attr(\"x\",0).attr(\"y\",0).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"No category connections found in the selected data\")}else e.append(\"text\").attr(\"class\",\"no-data-message\").attr(\"x\",0).attr(\"y\",0).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"No data available for the selected filters\")}var d=exports.default={initializeInterconnectionChart:s,updateInterconnectionChart:u};"},"sourceMaps":null,"error":null,"hash":"17c309f8c8df30865dfc6376c0e5454d","cacheData":{"env":{}}}