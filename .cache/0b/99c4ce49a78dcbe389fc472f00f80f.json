{"id":"KAS3","dependencies":[{"name":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\package.json","includedInParent":true,"mtime":1742042086953},{"name":"d3","loc":{"line":4,"column":20,"index":94},"parent":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\src\\modules\\interconnectionChart.js","resolved":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\node_modules\\d3\\index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0,exports.initializeInterconnectionChart=s,exports.updateInterconnectionChart=u;var t=n(require(\"d3\"));function e(t){if(\"function\"!=typeof WeakMap)return null;var n=new WeakMap,r=new WeakMap;return(e=function(t){return t?r:n})(t)}function n(t,n){if(!n&&t&&t.__esModule)return t;if(null===t||\"object\"!=typeof t&&\"function\"!=typeof t)return{default:t};var r=e(n);if(r&&r.has(t))return r.get(t);var a={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(\"default\"!==i&&{}.hasOwnProperty.call(t,i)){var c=o?Object.getOwnPropertyDescriptor(t,i):null;c&&(c.get||c.set)?Object.defineProperty(a,i,c):a[i]=t[i]}return a.default=t,r&&r.set(t,a),a}function r(t,e){return l(t)||c(t,e)||o(t,e)||a()}function a(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function o(t,e){if(t){if(\"string\"==typeof t)return i(t,e);var n={}.toString.call(t).slice(8,-1);return\"Object\"===n&&t.constructor&&(n=t.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(t):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){var n=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=n){var r,a,o,i,c=[],l=!0,s=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(c.push(r.value),c.length!==e);l=!0);}catch(t){s=!0,a=t}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}function l(t){if(Array.isArray(t))return t}function s(){var e=t.select(\"#interconnection-chart\"),n=40,r=40,a=40,o=40,i=document.getElementById(\"interconnection-chart\").clientWidth||500,c=Math.max(i-o-r,100),l=300-n-a,s=e.append(\"svg\").attr(\"width\",c+o+r).attr(\"height\",l+n+a).append(\"g\").attr(\"transform\",\"translate(\".concat(c/2+o,\",\").concat(l/2+n,\")\"));return s.append(\"text\").attr(\"class\",\"placeholder-text\").attr(\"x\",0).attr(\"y\",0).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"Loading interconnection visualization...\"),s}function u(e,n){if(console.log(\"Updating interconnection chart with \".concat(n.length,\" data points\")),e.selectAll(\"*\").remove(),0!==n.length){var a=new Set,o=new Set;n.forEach(function(t){Array.isArray(t[\"Corruption Categories\"])&&t[\"Corruption Categories\"].forEach(function(t){t&&t.trim()&&a.add(t)}),Array.isArray(t[\"Sector Categories\"])&&t[\"Sector Categories\"].forEach(function(t){t&&t.trim()&&o.add(t)})});var i=function(t,e,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o={};return Array.from(t).forEach(function(t){o[t]=0,e.forEach(function(e){Array.isArray(e[n])&&e[n].includes(t)&&o[t]++})}),Object.entries(o).sort(function(t,e){return e[1]-t[1]}).slice(0,a).map(function(t){var e=r(t,2);return{name:e[0],count:e[1],type:n}})},c=i(a,n,\"Corruption Categories\",5),l=i(o,n,\"Sector Categories\",5),s=[],u=[];if(c.forEach(function(t){l.forEach(function(e){var r=0;n.forEach(function(n){var a=Array.isArray(n[\"Corruption Categories\"])&&n[\"Corruption Categories\"].includes(t.name),o=Array.isArray(n[\"Sector Categories\"])&&n[\"Sector Categories\"].includes(e.name);a&&o&&r++}),r>0&&u.push({source:t.name,target:e.name,value:r})}),s.push({id:t.name,group:\"integrity\",count:t.count})}),l.forEach(function(t){s.push({id:t.name,group:\"health\",count:t.count})}),0!==u.length){var d=document.getElementById(\"interconnection-chart\").clientWidth||600,f=.4*Math.min(d,300),p=t.scaleOrdinal().domain([\"integrity\",\"health\"]).range([\"#3694d1\",\"#e5007d\"]),y=t.scaleLinear().domain([0,t.max(s,function(t){return t.count})]).range([5,15]),h=t.scaleLinear().domain([0,t.max(u,function(t){return t.value})]).range([1,5]),g=t.forceSimulation(s).force(\"link\",t.forceLink(u).id(function(t){return t.id}).distance(.7*f)).force(\"charge\",t.forceManyBody().strength(-50)).force(\"center\",t.forceCenter(0,0)).force(\"collide\",t.forceCollide().radius(function(t){return y(t.count)+15}).strength(1.9));e.append(\"circle\").attr(\"r\",f).style(\"fill\",\"none\").style(\"stroke\",\"#eee\").style(\"stroke-width\",1).style(\"stroke-dasharray\",\"3,3\");var v=e.append(\"g\").attr(\"class\",\"links\").selectAll(\"path\").data(u).enter().append(\"path\").attr(\"class\",\"link\").style(\"stroke\",function(t){var n=\"link-gradient-\".concat(t.source.id.replace(/\\s+/g,\"-\"),\"-\").concat(t.target.id.replace(/\\s+/g,\"-\")),r=e.append(\"defs\").append(\"linearGradient\").attr(\"id\",n).attr(\"gradientUnits\",\"userSpaceOnUse\");return r.append(\"stop\").attr(\"offset\",\"0%\").attr(\"stop-color\",p(\"integrity\")),r.append(\"stop\").attr(\"offset\",\"100%\").attr(\"stop-color\",p(\"health\")),\"url(#\".concat(n,\")\")}).style(\"stroke-width\",function(t){return h(t.value)}).style(\"stroke-opacity\",.6).style(\"fill\",\"none\"),m=e.append(\"g\").attr(\"class\",\"nodes\").selectAll(\"g\").data(s).enter().append(\"g\").attr(\"class\",\"node\");m.append(\"circle\").attr(\"r\",function(t){return y(t.count)}).attr(\"fill\",function(t){return p(t.group)}).style(\"stroke\",\"#fff\").style(\"stroke-width\",1.5).style(\"cursor\",\"pointer\").on(\"mouseover\",function(e){var n=u.filter(function(t){return t.source.id===e.id||t.target.id===e.id}).map(function(t){return t.source.id===e.id?t.target.id:t.source.id});t.selectAll(\".link\").style(\"stroke-opacity\",function(t){return t.source.id===e.id||t.target.id===e.id?1:.1}),t.selectAll(\".node circle\").style(\"opacity\",function(t){return t.id===e.id||n.includes(t.id)?1:.2}),t.selectAll(\".node text\").style(\"opacity\",function(t){return t.id===e.id||n.includes(t.id)?1:.2});var r=t.select(\"#interconnection-chart\").append(\"div\").attr(\"class\",\"chart-tooltip\").style(\"position\",\"absolute\").style(\"left\",\"\".concat(t.event.pageX-t.select(\"#interconnection-chart\").node().getBoundingClientRect().left,\"px\")).style(\"top\",\"\".concat(t.event.pageY-t.select(\"#interconnection-chart\").node().getBoundingClientRect().top-40,\"px\")),a=u.filter(function(t){return t.source.id===e.id||t.target.id===e.id}).length;r.html('\\n                <div class=\"chart-tooltip-title\">'.concat(e.id,'</div>\\n                <div><span class=\"chart-tooltip-value\">').concat(e.count,\"</span> articles</div>\\n                <div>Connected to \").concat(a,\" \").concat(\"integrity\"===e.group?\"health\":\"integrity\",\" categories</div>\\n            \"))}).on(\"mouseout\",function(){t.selectAll(\".link\").style(\"stroke-opacity\",.6),t.selectAll(\".node circle\").style(\"opacity\",1),t.selectAll(\".node text\").style(\"opacity\",1),t.selectAll(\".chart-tooltip\").remove()}),m.append(\"text\").text(function(t){return t.id.length>15?t.id.substring(0,12)+\"...\":t.id}).attr(\"dy\",function(t){return y(t.count)+12}).style(\"text-anchor\",\"middle\").style(\"font-size\",\"10px\").style(\"fill\",function(e){return t.rgb(p(e.group)).darker()}).style(\"pointer-events\",\"none\").style(\"font-weight\",\"bold\"),e.append(\"text\").attr(\"x\",-f-30).attr(\"y\",15-f).text(\"Integrity Categories\").style(\"font-size\",\"11px\").style(\"fill\",p(\"integrity\")).style(\"font-weight\",\"bold\"),e.append(\"text\").attr(\"x\",f-50).attr(\"y\",15-f).text(\"Health Categories\").style(\"font-size\",\"11px\").style(\"fill\",p(\"health\")).style(\"font-weight\",\"bold\"),v.attr(\"stroke-dasharray\",function(){var t=this.getTotalLength();return\"\".concat(t,\" \").concat(t)}).attr(\"stroke-dashoffset\",function(){return this.getTotalLength()}).transition().duration(1e3).ease(t.easeLinear).attr(\"stroke-dashoffset\",0),m.attr(\"opacity\",0).transition().delay(function(t,e){return 50*e}).duration(500).attr(\"opacity\",1),g.on(\"tick\",function(){s.forEach(function(t){if(\"integrity\"===t.group){var e=Math.PI+Math.random()*Math.PI-Math.PI/2;t.x=Math.cos(e)*f*.8,t.y=Math.sin(e)*f*.8}else{var n=Math.random()*Math.PI-Math.PI/2;t.x=Math.cos(n)*f*.8,t.y=Math.sin(n)*f*.8}}),v.attr(\"d\",function(t){var e=t.target.x-t.source.x,n=t.target.y-t.source.y,r=1.5*Math.sqrt(e*e+n*n);return\"M\".concat(t.source.x,\",\").concat(t.source.y,\"A\").concat(r,\",\").concat(r,\" 0 0,1 \").concat(t.target.x,\",\").concat(t.target.y)}),m.attr(\"transform\",function(t){return\"translate(\".concat(t.x,\",\").concat(t.y,\")\")})}),g.alpha(1).restart(),setTimeout(function(){return g.stop()},2e3)}else e.append(\"text\").attr(\"class\",\"no-data-message\").attr(\"x\",0).attr(\"y\",0).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"No category connections found in the selected data\")}else e.append(\"text\").attr(\"class\",\"no-data-message\").attr(\"x\",0).attr(\"y\",0).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"No data available for the selected filters\")}var d=exports.default={initializeInterconnectionChart:s,updateInterconnectionChart:u};"},"sourceMaps":null,"error":null,"hash":"64b24ab86f3c149c44876416510bc5db","cacheData":{"env":{}}}