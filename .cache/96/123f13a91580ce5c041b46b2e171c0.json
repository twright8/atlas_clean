{"id":"XFm0","dependencies":[{"name":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\package.json","includedInParent":true,"mtime":1742042086953},{"name":"./constants","loc":{"line":1,"column":43,"index":43},"parent":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\src\\modules\\map.js","resolved":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\src\\modules\\constants.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.addMarkers=x,exports.clearMarkers=h,exports.createMarker=f,exports.default=void 0,exports.fitMapToBounds=y,exports.getMapBounds=M,exports.getMarkerIcon=m,exports.initializeMap=c,exports.isMapMoving=k,exports.onMoveEnd=void 0,exports.toggleLegend=v;var e,n,o,r,t=require(\"./constants\"),a=!1,i=0,s=5;function c(){console.time(\"Map Initialization\"),e=L.map(\"map\",{maxZoom:18,minZoom:2,zoomAnimation:!0,fadeAnimation:!0,markerZoomAnimation:!0,zoomSnap:.5,zoomDelta:.5,wheelPxPerZoomLevel:120}).setView([0,0],2);try{o=L.markerClusterGroup({chunkedLoading:!0,chunkInterval:200,chunkDelay:50,maxClusterRadius:80,disableClusteringAtZoom:16,spiderfyOnMaxZoom:!0,animate:!0,animateAddingMarkers:!0,spiderfyDistanceMultiplier:1.5,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,iconCreateFunction:function(e){var n,o=e.getChildCount();return n=\"marker-cluster marker-cluster-\"+(o<10?\"small\":o<100?\"medium\":\"large\"),L.divIcon({html:\"<div><span>\"+o+\"</span></div>\",className:n,iconSize:L.point(40,40)})}}),console.log(\"Using MarkerClusterGroup for markers\")}catch(i){console.error(\"Leaflet.markercluster is not loaded, falling back to normal markers:\",i),o=L.layerGroup()}e.addLayer(o);var a=L.tileLayer(t.tileLayers.openStreetMap.url,t.tileLayers.openStreetMap.options);return n=a.addTo(e),l(),u(),g(),console.timeEnd(\"Map Initialization\"),{map:e,markers:o,legend:r}}function l(){(r=L.control({position:t.markerSettings.legendPosition})).onAdd=function(e){var n=L.DomUtil.create(\"div\",\"info legend\");return n.innerHTML='\\n            <div class=\"legend-content\">\\n                <h4>Location Precision</h4>\\n                <i style=\"color: #3694d1;\" class=\"fa fa-map-marker\"></i> Specific Location in Country (e.g., city, facility)<br>\\n                <i style=\"color: #e5007d;\" class=\"fa fa-map-marker\"></i> Country Only (no specific location)\\n            </div>\\n        ',n}}function u(){n.on(\"tileerror\",function(e){console.log(\"Tile loading error:\",e),++i>=s&&(console.log(\"\".concat(s,\" consecutive errors. Switching tile layer.\")),d(),i=0)}),n.on(\"tileload\",function(){i=0})}function d(){e.removeLayer(n);var o=L.tileLayer(t.tileLayers.openStreetMap.url,t.tileLayers.openStreetMap.options),r=L.tileLayer(t.tileLayers.stamenTerrain.url,t.tileLayers.stamenTerrain.options);n._url===t.tileLayers.openStreetMap.url?(n=r.addTo(e),console.log(\"Switched to Stamen Terrain tiles\")):(n=o.addTo(e),console.log(\"Switched to OpenStreetMap tiles\"))}var p=exports.onMoveEnd=null;function g(){e.on(\"movestart\",function(){e.isMoving=function(){return!0}}),e.on(\"moveend\",function(){e.isMoving=function(){return!1},\"function\"==typeof p&&p()})}function m(e){return e?L.divIcon(t.markerSettings.countryIcon):L.divIcon(t.markerSettings.specificIcon)}function f(e){var n=m(e.country_level),o=e.Title||\"No Title\",r=e.country||\"Unknown\",t=e.url||\"#\",a=e.Date||\"Unknown Date\",i=Array.isArray(e[\"Corruption Categories\"])?String(e[\"Corruption Categories\"]).replace(/,(?=[^\\s])/g,\", \"):\"\",s=Array.isArray(e[\"Sector Categories\"])?String(e[\"Sector Categories\"]).replace(/,(?=[^\\s])/g,\", \"):\"\";return L.marker([e.lat,e.long],{icon:n}).bindPopup('\\n            <div class=\"popup-content\">\\n                <h3 class=\"popup-title\">\"'.concat(o,'\"</h3>\\n                <div class=\"popup-details\">\\n                    <p><strong>Country:</strong> ').concat(r,\"</p>\\n                    <p><strong>URL:</strong> \").concat(\"#\"!==t?'<a href=\"'.concat(t,'\" target=\"_blank\">Link</a>'):\"No URL\",\"</p>\\n                    <p><strong>Date:</strong> \").concat(a,\"</p>\\n                    <p><strong>Integrity Area:</strong> \").concat(i,\"</p>\\n                    <p><strong>Sector Area:</strong> \").concat(s,\"</p>\\n                </div>\\n            </div>\\n        \"))}function v(n){n&&!a?(r.addTo(e),a=!0):!n&&a&&(r.remove(),a=!1)}function y(){try{var n=o.getBounds();n.isValid()&&e.fitBounds(n,{padding:[30,30],maxZoom:12,animate:!0,duration:.5})}catch(a){try{var r=o.getLayers();if(r&&r.length>0){var t=L.latLngBounds();r.forEach(function(e){t.extend(e.getLatLng())}),t.isValid()&&e.fitBounds(t,{padding:[30,30],maxZoom:12,animate:!0,duration:.5})}}catch(i){console.error(\"Error fitting map to bounds:\",i)}}}function M(){return e.getBounds()}function k(){return!!e.isMoving&&e.isMoving()}function h(){o.clearLayers()}function x(e){try{o.addLayers(e)}catch(n){e.forEach(function(e){return o.addLayer(e)})}}var S=exports.default={initializeMap:c,getMarkerIcon:m,createMarker:f,toggleLegend:v,fitMapToBounds:y,getMapBounds:M,isMapMoving:k,clearMarkers:h,addMarkers:x};"},"sourceMaps":null,"error":null,"hash":"85bdb4aaf034635fa51d01961b28538a","cacheData":{"env":{}}}