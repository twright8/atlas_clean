{"id":"Wn84","dependencies":[{"name":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\package.json","includedInParent":true,"mtime":1742042086953},{"name":"d3","loc":{"line":4,"column":20,"index":123},"parent":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\src\\modules\\dashboardCharts.js","resolved":"C:\\Users\\Tom\\PycharmProjects\\health_atlas\\atlas_clean\\node_modules\\d3\\index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0,exports.initializeCategoryChart=h,exports.initializeTimeSeriesChart=p,exports.initializeTopCountriesChart=f,exports.updateCategoryChart=m,exports.updateTimeSeriesChart=y,exports.updateTopCountriesChart=x;var t,e,a,r=o(require(\"d3\"));function n(t){if(\"function\"!=typeof WeakMap)return null;var e=new WeakMap,a=new WeakMap;return(n=function(t){return t?a:e})(t)}function o(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||\"object\"!=typeof t&&\"function\"!=typeof t)return{default:t};var a=n(e);if(a&&a.has(t))return a.get(t);var r={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in t)if(\"default\"!==i&&{}.hasOwnProperty.call(t,i)){var l=o?Object.getOwnPropertyDescriptor(t,i):null;l&&(l.get||l.set)?Object.defineProperty(r,i,l):r[i]=t[i]}return r.default=t,a&&a.set(t,r),r}function i(t,e){return d(t)||u(t,e)||c(t,e)||l()}function l(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function c(t,e){if(t){if(\"string\"==typeof t)return s(t,e);var a={}.toString.call(t).slice(8,-1);return\"Object\"===a&&t.constructor&&(a=t.constructor.name),\"Map\"===a||\"Set\"===a?Array.from(t):\"Arguments\"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}function u(t,e){var a=null==t?null:\"undefined\"!=typeof Symbol&&t[Symbol.iterator]||t[\"@@iterator\"];if(null!=a){var r,n,o,i,l=[],c=!0,s=!1;try{if(o=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;c=!1}else for(;!(c=(r=o.call(a)).done)&&(l.push(r.value),l.length!==e);c=!0);}catch(t){s=!0,n=t}finally{try{if(!c&&null!=a.return&&(i=a.return(),Object(i)!==i))return}finally{if(s)throw n}}return l}}function d(t){if(Array.isArray(t))return t}function p(){var e=r.select(\"#time-series-chart\"),a=20,n=30,o=60,i=60,l=document.getElementById(\"time-series-chart\").clientWidth||500,c=Math.max(l-i-n,100),s=260-a-o,u=e.append(\"svg\").attr(\"width\",c+i+n).attr(\"height\",s+a+o+130).append(\"g\").attr(\"transform\",\"translate(\".concat(i,\",\").concat(a,\")\")),d=r.scaleTime().domain([,]).range([0,c]);return u.append(\"g\").attr(\"class\",\"x-axis\").attr(\"transform\",\"translate(0,\".concat(s,\")\")).call(r.axisBottom(d)),u.append(\"g\").attr(\"class\",\"y-axis\").append(\"text\").attr(\"transform\",\"rotate(-90)\").attr(\"y\",-40).attr(\"x\",-s/2).attr(\"fill\",\"#333\").style(\"text-anchor\",\"middle\").text(\"Articles\"),u.append(\"g\").attr(\"class\",\"grid-lines\").style(\"stroke-dasharray\",\"3,3\").style(\"stroke\",\"#e0e0e0\").style(\"stroke-width\",.5),t=u,u}function h(){var t=r.select(\"#category-chart\"),a=20,n=30,o=50,i=160,l=document.getElementById(\"category-chart\").clientWidth||500,c=Math.max(l-i-n,100),s=260-a-o,u=t.append(\"svg\").attr(\"width\",c+i+n).attr(\"height\",s+a+o).append(\"g\").attr(\"transform\",\"translate(\".concat(i,\",\").concat(a,\")\"));return u.append(\"g\").attr(\"class\",\"x-axis\").attr(\"transform\",\"translate(0,\".concat(s,\")\")).append(\"text\").attr(\"y\",40).attr(\"x\",c/2).attr(\"fill\",\"#333\").style(\"text-anchor\",\"middle\"),u.append(\"g\").attr(\"class\",\"y-axis\"),e=u,u}function f(){var t=r.select(\"#top-countries-chart\"),e=20,n=30,o=50,i=110,l=document.getElementById(\"top-countries-chart\").clientWidth||500,c=Math.max(l-i-n,100),s=260-e-o,u=t.append(\"svg\").attr(\"width\",c+i+n).attr(\"height\",s+e+o).append(\"g\").attr(\"transform\",\"translate(\".concat(i,\",\").concat(e,\")\"));return u.append(\"g\").attr(\"class\",\"x-axis\").attr(\"transform\",\"translate(0,\".concat(s,\")\")).append(\"text\").attr(\"y\",40).attr(\"x\",c/2).attr(\"fill\",\"#333\").style(\"text-anchor\",\"middle\"),u.append(\"g\").attr(\"class\",\"y-axis\"),a=u,u}function y(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{yearly:!1},o=n.yearly?\"%Y\":\"%Y-%m\",i=n.yearly?\"%Y\":\"%b %Y\",l=r.nest().key(function(t){var e=t.parsedDate;return e?r.timeFormat(o)(e):\"Unknown\"}).rollup(function(t){return t.length}).entries(e).filter(function(t){return\"Unknown\"!==t.key}).sort(function(t,e){return r.ascending(t.key,e.key)});if(0===l.length)return t.selectAll(\".line-path, .data-point, .hover-area, .annotation, .grid-lines line\").remove(),void(t.select(\".no-data-message\").empty()&&t.append(\"text\").attr(\"class\",\"no-data-message\").attr(\"x\",t.node().getBBox().width/2).attr(\"y\",t.node().getBBox().height/2).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"No data available for the selected filters\"));t.select(\".no-data-message\").remove(),l.forEach(function(t){n.yearly?t.date=r.timeParse(\"%Y\")(t.key):t.date=r.timeParse(\"%Y-%m\")(t.key)});var c=20,s=30,u=60,d=60,p=document.getElementById(\"time-series-chart\").clientWidth||500,h=Math.max(p-d-s,100),f=260-c-u,y=r.extent(l,function(t){return t.date}),m=y[0],x=y[1],g=x-m,v=new Date(x.getTime()+.2*g),b=r.scaleTime().domain([m,v]).range([0,h]).nice(),w=r.scaleLinear().domain([0,1.1*r.max(l,function(t){return t.value})]).range([f,0]).nice();t.select(\".x-axis\").transition().duration(500).call(r.axisBottom(b).ticks(n.yearly?l.length:Math.min(l.length,12)).tickFormat(r.timeFormat(i))).selectAll(\"text\").style(\"text-anchor\",\"end\").attr(\"dx\",\"-.8em\").attr(\"dy\",\".15em\").attr(\"transform\",\"rotate(-45)\"),t.select(\".y-axis\").transition().duration(500).call(r.axisLeft(w).ticks(5));var C=t.select(\".grid-lines\").selectAll(\"line.horizontal\").data(w.ticks(5));C.exit().remove(),C.enter().append(\"line\").attr(\"class\",\"horizontal\").merge(C).attr(\"x1\",0).attr(\"x2\",h).attr(\"y1\",function(t){return w(t)}).attr(\"y2\",function(t){return w(t)}),t.selectAll(\".line-path, .area-path, .data-point, .hover-area, .annotation\").remove();var k=r.area().x(function(t){return b(t.date)}).y0(f).y1(function(t){return w(t.value)}).curve(r.curveMonotoneX);t.append(\"path\").datum(l).attr(\"class\",\"area-path\").attr(\"fill\",\"rgba(54, 148, 209, 0.1)\").attr(\"d\",k);var A=r.line().x(function(t){return b(t.date)}).y(function(t){return w(t.value)}).curve(r.curveMonotoneX),B=t.append(\"path\").datum(l).attr(\"class\",\"line-path\").attr(\"fill\",\"none\").attr(\"stroke\",\"#3694d1\").attr(\"stroke-width\",3).attr(\"d\",A),M=B.node().getTotalLength();B.attr(\"stroke-dasharray\",M+\" \"+M).attr(\"stroke-dashoffset\",M).transition().duration(1e3).ease(r.easeLinear).attr(\"stroke-dashoffset\",0),t.selectAll(\".data-point\").data(l).enter().append(\"circle\").attr(\"class\",\"data-point\").attr(\"cx\",function(t){return b(t.date)}).attr(\"cy\",function(t){return w(t.value)}).attr(\"r\",0).attr(\"fill\",\"#e5007d\").transition().delay(function(t,e){return 50*e}).duration(500).attr(\"r\",3),t.append(\"g\").attr(\"class\",\"hover-area\").selectAll(\"rect\").data(l).enter().append(\"rect\").attr(\"x\",function(t){return b(t.date)-h/(2*l.length)}).attr(\"y\",0).attr(\"width\",h/l.length).attr(\"height\",f).attr(\"fill\",\"transparent\").on(\"mouseover\",function(t){r.select(this.parentNode.parentNode).selectAll(\".data-point\").filter(function(e){return e.key===t.key}).transition().duration(100).attr(\"r\",7).attr(\"fill\",\"#ff4081\");var a=r.select(\"#time-series-chart\").append(\"div\").attr(\"class\",\"chart-tooltip\").style(\"position\",\"absolute\").style(\"left\",\"10px\").style(\"top\",\"10px\").style(\"z-index\",\"1000\").style(\"background-color\",\"rgba(255, 255, 255, 0.9)\").style(\"border\",\"1px solid #ddd\").style(\"padding\",\"8px\").style(\"border-radius\",\"4px\"),o=n.yearly?\"%Y\":\"%B %Y\";a.html('\\n                <div class=\"chart-tooltip-title\">'.concat(r.timeFormat(o)(t.date),'</div>\\n                <div><span class=\"chart-tooltip-value\">').concat(t.value,\"</span> articles</div>\\n                <div>\").concat(Math.round(t.value/e.length*100),\"% of selected data</div>\\n            \"))}).on(\"mouseout\",function(){r.select(this.parentNode.parentNode).selectAll(\".data-point\").transition().duration(100).attr(\"r\",5).attr(\"fill\",\"#e5007d\"),r.selectAll(\".chart-tooltip\").remove()});var z=l.reduce(function(t,e){return e.value>t.value?e:t},l[0]);t.append(\"circle\").attr(\"class\",\"annotation\").attr(\"cx\",b(z.date)).attr(\"cy\",w(z.value)).attr(\"r\",7).attr(\"fill\",\"none\").attr(\"stroke\",\"#e5007d\").attr(\"stroke-width\",2).attr(\"opacity\",0).transition().delay(1200).duration(300).attr(\"opacity\",1),t.append(\"text\").attr(\"class\",\"annotation\").attr(\"x\",b(z.date)).attr(\"y\",w(z.value)-15).attr(\"text-anchor\",\"middle\").attr(\"font-size\",\"12px\").attr(\"fill\",\"#e5007d\").text(\"Peak: \".concat(z.value)).attr(\"opacity\",0).transition().delay(1200).duration(300).attr(\"opacity\",1)}function m(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{showHealthCategories:!1},n=a.showHealthCategories?\"Sector Categories\":\"Corruption Categories\";r.select(\"#category-breakdown-card .card-header h3\").text(a.showHealthCategories?\"Health Sector Categories\":\"Integrity Issues Categories\");var o=[],l={};e.forEach(function(t){Array.isArray(t[n])&&t[n].forEach(function(t){t&&t.trim()&&(l[t]=(l[t]||0)+1)})}),Object.entries(l).forEach(function(t){var e=i(t,2),a=e[0],r=e[1];o.push({category:a,count:r})}),o.sort(function(t,e){return e.count-t.count});var c=o.slice(0,10);if(0===c.length)return t.selectAll(\".category-bar, .count-label\").remove(),void(t.select(\".no-data-message\").empty()&&t.append(\"text\").attr(\"class\",\"no-data-message\").attr(\"x\",t.node().getBBox().width/2).attr(\"y\",t.node().getBBox().height/2).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"No data available for the selected filters\"));t.select(\".no-data-message\").remove();var s=20,u=30,d=50,p=160,h=document.getElementById(\"category-chart\").clientWidth||500,f=Math.max(h-p-u,100),y=260-s-d,m=r.scaleLinear().domain([0,1.35*r.max(c,function(t){return t.count})]).range([0,f]),x=r.scaleBand().domain(c.map(function(t){return t.category})).range([0,y]).padding(.2);t.select(\".x-axis\").transition().duration(500).call(r.axisBottom(m).ticks(5)),t.select(\".y-axis\").transition().duration(500).call(r.axisLeft(x)).selectAll(\"text\").style(\"text-anchor\",\"end\");var g=a.showHealthCategories?\"#e5007d\":\"#3694d1\",v=t.selectAll(\".category-bar\").data(c,function(t){return t.category});v.exit().transition().duration(300).attr(\"width\",0).remove(),v.transition().duration(500).attr(\"y\",function(t){return x(t.category)}).attr(\"height\",x.bandwidth()).attr(\"width\",function(t){return m(t.count)}).attr(\"fill\",g),v.enter().append(\"rect\").attr(\"class\",\"category-bar\").attr(\"x\",0).attr(\"y\",function(t){return x(t.category)}).attr(\"height\",x.bandwidth()).attr(\"width\",0).attr(\"fill\",g).transition().duration(800).attr(\"width\",function(t){return m(t.count)}),t.selectAll(\".category-bar\").on(\"mouseover\",function(t){r.select(this).transition().duration(100).attr(\"fill\",a.showHealthCategories?\"#3694d1\":\"#e5007d\"),r.select(\"#category-chart\").append(\"div\").attr(\"class\",\"chart-tooltip\").style(\"position\",\"absolute\").style(\"left\",\"10px\").style(\"top\",\"10px\").html('\\n                <div class=\"chart-tooltip-title\">'.concat(t.category,'</div>\\n                <div><span class=\"chart-tooltip-value\">').concat(t.count,\"</span> articles</div>\\n                <div>\").concat((t.count/e.length*100).toFixed(1),\"% of selected data</div>\\n            \"))}).on(\"mouseout\",function(){r.select(this).transition().duration(100).attr(\"fill\",g),r.selectAll(\".chart-tooltip\").remove()});var b=t.selectAll(\".count-label\").data(c,function(t){return t.category});b.exit().remove(),b.transition().duration(500).attr(\"x\",function(t){return m(t.count)+5}).attr(\"y\",function(t){return x(t.category)+x.bandwidth()/2+5}).text(function(t){return t.count}),b.enter().append(\"text\").attr(\"class\",\"count-label\").attr(\"x\",function(t){return m(t.count)+5}).attr(\"y\",function(t){return x(t.category)+x.bandwidth()/2+5}).text(function(t){return t.count}).attr(\"fill\",\"#333\").attr(\"font-size\",\"12px\").attr(\"opacity\",0).transition().duration(500).attr(\"opacity\",1)}function x(t,e){if((arguments.length>2&&void 0!==arguments[2]?arguments[2]:{mapView:!1}).mapView)updateCountryMapChart(t,e);else{var a=[],n={};e.forEach(function(t){t.country&&t.country.trim()&&(n[t.country]=(n[t.country]||0)+1)}),Object.entries(n).forEach(function(t){var e=i(t,2),r=e[0],n=e[1];a.push({country:r,count:n})}),a.sort(function(t,e){return e.count-t.count});var o=a.slice(0,10);if(0===o.length)return t.selectAll(\".country-bar, .count-label\").remove(),void(t.select(\".no-data-message\").empty()&&t.append(\"text\").attr(\"class\",\"no-data-message\").attr(\"x\",t.node().getBBox().width/2).attr(\"y\",t.node().getBBox().height/2).attr(\"text-anchor\",\"middle\").style(\"font-size\",\"14px\").style(\"fill\",\"#666\").text(\"No data available for the selected filters\"));t.select(\".no-data-message\").remove();var l=20,c=30,s=50,u=110,d=document.getElementById(\"top-countries-chart\").clientWidth||500,p=Math.max(d-u-c,100),h=260-l-s,f=r.scaleLinear().domain([0,1.35*r.max(o,function(t){return t.count})]).range([0,p]),y=r.scaleBand().domain(o.map(function(t){return t.country})).range([0,h]).padding(.2);t.select(\".x-axis\").transition().duration(500).call(r.axisBottom(f).ticks(5)),t.select(\".y-axis\").transition().duration(500).call(r.axisLeft(y)).selectAll(\"text\").style(\"text-anchor\",\"end\");var m=t.selectAll(\".country-bar\").data(o,function(t){return t.country});m.exit().transition().duration(300).attr(\"width\",0).remove(),m.transition().duration(500).attr(\"y\",function(t){return y(t.country)}).attr(\"height\",y.bandwidth()).attr(\"width\",function(t){return f(t.count)}).attr(\"fill\",\"#e5007d\"),m.enter().append(\"rect\").attr(\"class\",\"country-bar\").attr(\"x\",0).attr(\"y\",function(t){return y(t.country)}).attr(\"height\",y.bandwidth()).attr(\"width\",0).attr(\"fill\",\"#e5007d\").transition().duration(800).attr(\"width\",function(t){return f(t.count)}),t.selectAll(\".country-bar\").on(\"mouseover\",function(t){r.select(this).transition().duration(100).attr(\"fill\",\"#3694d1\"),r.select(\"#top-countries-chart\").append(\"div\").attr(\"class\",\"chart-tooltip\").style(\"position\",\"absolute\").style(\"left\",\"10px\").style(\"top\",\"10px\").html('\\n                <div class=\"chart-tooltip-title\">'.concat(t.country,'</div>\\n                <div><span class=\"chart-tooltip-value\">').concat(t.count,\"</span> articles</div>\\n                <div>\").concat((t.count/e.length*100).toFixed(1),\"% of selected data</div>\\n            \"))}).on(\"mouseout\",function(){r.select(this).transition().duration(100).attr(\"fill\",\"#e5007d\"),r.selectAll(\".chart-tooltip\").remove()});var x=t.selectAll(\".count-label\").data(o,function(t){return t.country});x.exit().remove(),x.transition().duration(500).attr(\"x\",function(t){return f(t.count)+5}).attr(\"y\",function(t){return y(t.country)+y.bandwidth()/2+5}).text(function(t){return t.count}),x.enter().append(\"text\").attr(\"class\",\"count-label\").attr(\"x\",function(t){return f(t.count)+5}).attr(\"y\",function(t){return y(t.country)+y.bandwidth()/2+5}).text(function(t){return t.count}).attr(\"fill\",\"#333\").attr(\"font-size\",\"12px\").attr(\"opacity\",0).transition().duration(500).attr(\"opacity\",1)}}var g=exports.default={initializeTimeSeriesChart:p,initializeCategoryChart:h,initializeTopCountriesChart:f,updateTimeSeriesChart:y,updateCategoryChart:m,updateTopCountriesChart:x};"},"sourceMaps":null,"error":null,"hash":"db4b1b02cf3dd636d63c40358686258a","cacheData":{"env":{}}}